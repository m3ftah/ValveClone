<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">

<dom-module id="my-fan">
  <template>
    <style include="shared-styles">
    .interrupt{
        flex-grow: 0.5;
    }
    .collapse-content {
      padding: 15px;
      border: 1px solid #dedede;
      border-radius: 5px;
    }
    .flexBox {
        display : flex;
        justify-content:  space-between ;
        align-items: center;
        padding: 10px 15px;
        margin-top: 20px;
        font-size: 18px;
        cursor: pointer;
    }
    .heading {
      padding: 10px 15px;
      margin-top: 20px;
      background-color: #f3f3f3;
      border: 1px solid #dedede;
      border-top-left-radius: 5px;
      border-top-right-radius: 5px;
      font-size: 18px;
      cursor: pointer;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
    }
      :host {
        display: block;
      }
      span,
      input {
        @apply(--paper-font-body2);
      }
      .icon1{
          opacity: 0.54;
          width : 50px;
          height : 50px;
      }
    .icon2{
        opacity: 0.54;
    }

    </style>
    <div class="flexBox">
        <iron-icon icon="icons:power-settings-new" class="icon1"></iron-icon>
        <paper-toggle-button class="interrupt" id="interrupt" style="float:left;">intérrupteur <span>{{pin}}</span></paper-toggle-button>
        <iron-icon on-click="toggle" icon="icons:settings" class="icon2"></iron-icon>
    </div>
      <iron-collapse id="collapse">
        <div class="collapse-content">
          <h2>Réglage de ventilateurs</h2>
            <my-slider val="{{marche}}" label="Marche :"></my-slider>
            <my-slider val="{{arret}}" label="Arret :"></my-slider>

          <paper-button id="button1" raised on-tap="envoyer">Envoyer</paper-button>
        </div>
      </iron-collapse>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'my-fan',

        properties: {
          pin :{
            type : String,
            value : 1
          },
          marche:{
            type: String,
            value: 2,
            notify : true
          },
          arret:{
            type: String,
            value: 1,
            notify : true
          },
          url:{
            type : String
          }
        },
        envoyer : function(){
          /*this.fire('fan-envoyer',
            )*/
          var mydata = {
            cmd : "fan",
            pin : this.pin,
            marche : this.marche,
            arret : this.arret
          };
          var ajaxRequest = this.$.ajaxPost;
          ajaxRequest.body = JSON.stringify(mydata);
          ajaxRequest.generateRequest();
        },
        toggle : function() {
          this.$.collapse.toggle();
        },
        postComplete : function(){
              console.log(this.postResponse);
        },
        ready: function() {
          var element = this;
          this.$.interrupt.addEventListener('change', function () {
              var mydata = {
                  cmd: "interrupt",
                  pin: element.pin,
                  value: this.checked ? 1 : 0
              };
              this.fire('interrupt',mydata);
          });
        }
      });
    })();
  </script>
</dom-module>
